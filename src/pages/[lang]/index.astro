---
import Header from "../../components/Header.astro";
import Welcome from "../../components/Welcome.astro";
import Layout from "../../layouts/Layout.astro";
import { getCollection, type CollectionEntry } from "astro:content";

export async function getStaticPaths() {
  const pages = await getCollection("home");

  const availableLangs = pages.map((page) => page.id.split("/")[0]);

  const paths = pages.map((page) => {
    const [lang] = page.id.split("/");
    return { params: { lang }, props: { page, availableLangs } };
  });

  return paths;
}

interface Props {
  page: CollectionEntry<"home">;
  availableLangs: string[];
}

const { lang } = Astro.params;
const { page, availableLangs } = Astro.props;
---

<Layout>
  <Welcome greetings={page.data.greetings}>
    <Header currentLang={lang} availableLangs={availableLangs} slot="header" />
  </Welcome>
</Layout>
